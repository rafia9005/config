###############################
#           Backend           #
###############################
backend = "glx";
vsync = true;
use-damage = true;
refresh-rate = 0;
glx-no-stencil = true;
glx-no-rebind-pixmap = true;
dithered-present = false;

detect-client-opacity = true;
detect-transient = true;
detect-client-leader = true;
xrender-sync-fence = true;

log-level = "warn";

###############################
#        Opacity Settings     #
###############################
inactive-opacity = 0.95;
active-opacity = 0.95;
frame-opacity = 0.95;
frame-opacity-for-same-colors = true;

opacity-rule = [
  "95:class_g = '*'",
  "100:_NET_WM_STATE@:32a *= '_NET_WM_STATE_FULLSCREEN'"
];


fade-exclude = [];

###############################
#        Fading & Anim        #
###############################
fading = true;
fade-in-step = 0.02;
fade-out-step = 0.02;
fade-delta = 8;

animations = true;
animation-stiffness = 120;
animation-dampening = 15;
animate-open-close = true;
animate-move-resize = true;
animation-clamping = false;
animation-for-open-window = "zoom";
animation-for-close-window = "slide-down";
animation-for-unmap-window = "slide-down";

###############################
#           Blur              #
###############################
blur-method = "dual_kawase";
blur-strength = 4;
blur-background = true;
blur-background-frame = true;
blur-background-fixed = true;

###############################
#          Shadows            #
###############################
shadow = true;
shadow-radius = 50;
shadow-opacity = 0.35;
shadow-offset-x = -49;
shadow-offset-y = -47;
shadow-color = "#00020b";

###############################
#        Borders & Corners    #
###############################
corner-radius = 3;
rounded-corners = true;
inner-border-width = 1;

rounded-corners-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "class_g = 'polybar'",
  "_net_wm_state@:32a *= '_net_wm_state_fullscreen'"
];

###############################
#        Animation Rules      #
###############################
rules = (
  {
    match = "window_type = 'dropdown_menu' || window_type = 'popup_menu' || window_type = 'menu'";
    opacity = 0.9;
  },
  {
    match = "window_type = 'dock' || window_type = 'desktop'";
    blur-background = false;
    corner-radius = 0;
  },
  {
    match = "class_g *= 'i3lock' || _NET_WM_STATE@:32a *= '_NET_WM_STATE_FULLSCREEN'";
    shadow = false;
    corner-radius = 0;
  }
);

animations = (
  {
    triggers = ["open", "show"];
    opacity = {
      curve = "linear";
      duration = 0.15;
      start = "window-raw-opacity-before";
      end = "window-raw-opacity";
    };
    blur-opacity = {
      curve = "linear";
      duration = 0.1;
      delay = 0.15;
      start = "window-raw-opacity-before";
      end = "window-raw-opacity";
    };
    shadow-opacity = "opacity";
    scale-x = {
      curve = "cubic-bezier(0.24, 0.64, 0.79, 0.98)";
      duration = 0.15;
      start = 0.95;
      end = 1;
    };
    scale-y = "scale-x";
    offset-x = "(1 - scale-x) / 2 * window-width";
    offset-y = "(1 - scale-y) / 2 * window-height * 5";
    shadow-scale-x = "scale-x";
    shadow-scale-y = "scale-y";
    shadow-offset-x = "offset-x";
    shadow-offset-y = "offset-y";
  },
  {
    triggers = ["close", "hide"];
    opacity = {
      curve = "linear";
      duration = 0.15;
      start = "window-raw-opacity-before";
      end = "0";
    };
    blur-opacity = 0;
    shadow-opacity = "opacity";
    scale-x = {
      curve = "cubic-bezier(0.21, 0.02, 0.76, 0.36)";
      duration = 0.15;
      start = 1;
      end = 0.9;
    };
    scale-y = "scale-x";
    offset-x = "(1 - scale-x) / 2 * window-width";
    offset-y = "(1 - scale-y) / 2 * window-height * 5";
    shadow-scale-x = "scale-x";
    shadow-scale-y = "scale-y";
    shadow-offset-x = "offset-x";
    shadow-offset-y = "offset-y";
  },
  {
    triggers = [ "geometry" ];
    preset = "geometry-change";
  }
);

